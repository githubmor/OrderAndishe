//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool
//     Changes to this file will be lost if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
namespace BL
{
    using Stimulsoft.Report;
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Text;

	public class FileManagar
	{
        
        private List<ReportRow> ReportRows;
        private string Tarikh;
        

        public FileManagar(List<ReportRow> reportRows,string Tarikh )
        {
            this.ReportRows = reportRows;
            this.Tarikh = Tarikh;
        }

        
		public virtual void CreatFile(string fileName)
		{
            string path = Environment.GetFolderPath(Environment.SpecialFolder.Desktop);
            if (string.IsNullOrEmpty(fileName))
            {
                fileName = "Report";
            }
            var h = new Header();
            h.Tarikh= Tarikh;
            h.WeekDay= "شنبه";

            

            StiReport mainreport = new StiReport();
            mainreport.RegBusinessObject("Sefaresh", h);
            mainreport.RegBusinessObject("Items", ReportRows);
            mainreport.Load(AppDomain.CurrentDomain.BaseDirectory + "\\Report\\Report.mrt");
            mainreport.Render();
            mainreport.Show();
            mainreport.ExportDocument(StiExportFormat.Pdf, path +"\\"+fileName+".pdf");
		}

        
        
    }
    public class Header
    {
        public string Tarikh { get; set; }
        public string WeekDay { get; set; }
    }
}

